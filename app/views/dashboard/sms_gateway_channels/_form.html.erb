<div class="card-body">
  <%= simple_form_for([:dashboard, resource], html: { data: { controller: "sms-gateway-channels", turbo: false } }) do |f| %>

    <div class="row">
      <div class="col-sm-6">
        <%= f.input :name, maxlength: 128, hint: "A friendly name for the channel" %>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-6">
        <%= f.input(
            :sms_gateway_id,
            required: true,
            collection: resource.sms_gateways,
            disabled: resource.persisted?,
            selected: resource.sms_gateway_id || params.dig(:filter, :sms_gateway_id),
            prompt: "Please select",
            hint: "Either select a SMS gateway or channel group to associate this channel with.",
            input_html: {
              data: {
                behavior: "choices-input",
                sms_gateway_channels_target: "smsGatewayInput",
                action: "change->sms-gateway-channels#changeSMSGateway",
                sms_gateway_attributes: resource.sms_gateway_attributes
              }
            }
          )
        %>
      </div>

      <div class="col-sm-6">
        <%= f.input(
            :channel_group_id,
            collection: resource.carrier.sms_gateway_channel_groups,
            selected: resource.channel_group_id || params.dig(:filter, :channel_group_id),
            include_blank: true,
            input_html: {
              data: {
                behavior: "choices-input",
                choices_options: {
                  removeItemButton: true
                },
                sms_gateway_channels_target: "channelGroupInput"
              }
            }
          )
        %>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-6">
        <%= f.input(
            :slot_index,
            as: :integer,
            hint: "The SIM card slot index in the SMS gateway",
            input_html: {
              data: {
                default_value: resource.slot_index,
                sms_gateway_channels_target: "slotIndexInput"
              }
            }
          )
        %>
      </div>

      <div class="col-sm-6">
        <%= f.input(
            :phone_number_id,
            collection: resource.carrier.phone_numbers.map { |phone_number| [phone_number.number, phone_number.id] },
            selected: resource.phone_number_id,
            include_blank: true,
            input_html: { data: { behavior: "choices-input", choices_options: { removeItemButton: true, allowHTML: true } } },
            hint: "The phone number of the SIM card in this channel slot. #{link_to('Create new', new_dashboard_phone_number_path, target: '_blank')}".html_safe
          )
        %>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12">
        <%= f.input(
          :route_prefixes,
          as: :text,
          placeholder: "#{resource.carrier.country.country_code}15, #{resource.carrier.country.country_code}16",
          hint: "An optional comma seperated list of route prefixes. Must include the country code."
        ) %>
      </div>
    </div>

    <%= f.button :submit %>
  <% end %>
</div>
